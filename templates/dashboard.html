<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EchoMind | Dashboard</title>
  <link rel="stylesheet" href="/static/css/netflix.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>

<nav class="nav">
  <h2>EchoMind</h2>
  <div>
    <a href="/dashboard">Dashboard</a>
    <a href="/insights">Insights</a>
  </div>
</nav>

<div class="container">

  <!-- SESSION CONTROL -->
  <div class="card">
    <h3>Session Control</h3>

    <label>Mode</label>
    <select id="mode">
      <option value="study">Study</option>
      <option value="work">Work</option>
      <option value="creative">Creative</option>
    </select>

    <button onclick="initializeSession()">Initialize Session</button>

    <button id="analyzeBtn" class="danger" onclick="startRealtimeAnalysis()">
      â–¶ Start Real-Time Analysis
    </button>

    <!-- ğŸ”´ IMPORTANT: modal trigger -->
    <button id="terminateBtn" class="secondary" onclick="openModal()" disabled>
      Terminate Session
    </button>
  </div>

  <!-- ANALYZER -->
  <div class="card wide analyzer">

    <!-- LEFT PANEL -->
    <div class="analyzer-left">

      <div id="lockBox" class="lock locked">ğŸ”’</div>
      <h2 id="lock">MENTAL LOCK</h2>
      <h1 id="score">â€”</h1>

      <!-- Cognitive Intelligence -->
      <p id="cognitiveState" class="badge">
        Cognitive State: â€”
      </p>

      <p id="signals" class="signals">
        â€”
      </p>

      <div class="intervention-box">
        <h4>ğŸ§˜ Recommendation</h4>
        <p id="intervention">â€”</p>
      </div>

      <p id="status" class="status idle">
        Session not initialized.
      </p>

      <ul id="reasons"></ul>
    </div>

    <!-- RIGHT PANEL -->
    <div class="analyzer-right">
      <h3>Stress Trend</h3>
      <canvas id="graph" height="150"></canvas>
    </div>

  </div>

</div>

<!-- ==============================
     CONFIRM TERMINATION MODAL
================================= -->
<div id="confirmModal" class="modal hidden">
  <div class="modal-box">
    <h3>End Session?</h3>
    <p>Are you sure you want to terminate the current session?</p>
    <div style="margin-top: 15px;">
      <button class="danger" onclick="confirmTerminate()">Yes, Terminate</button>
      <button onclick="closeModal()">Cancel</button>
    </div>
  </div>
</div>
<!-- ğŸ§© PUZZLE MODAL -->
<div id="puzzleModal" class="modal hidden">
  <div class="modal-box">
    <h3>ğŸ” Cognitive Lock Challenge</h3>
    <p id="puzzleQuestion">â€”</p>

    <input id="puzzleAnswer" placeholder="Your answerâ€¦" />

    <p id="puzzleHint" class="hint"></p>

    <div style="margin-top: 15px;">
      <button class="danger" onclick="submitPuzzle()">Unlock</button>
      <button onclick="closePuzzle()">Cancel</button>
    </div>

    <p id="puzzleResult"></p>
  </div>
</div>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>